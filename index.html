<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>新年祝福</title>
    <style>
        body {
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            font-family: "楷体", KaiTi, "华文楷体", STKaiti, serif;
        }

        .message {
            color: #ff6b6b;
            font-size: 2em;
            text-align: center;
            animation: fadeIn 3s ease-in;
            margin-top: 10vh;
            transition: opacity 0.5s ease;
        }

        .poem-line {
            opacity: 0;
            animation: fadeInUp 1s ease-out forwards;
            margin: 12px 0;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
            transition: all 0.5s ease;
            font-size: 1.2em;
            letter-spacing: 2px;
        }

        .poem-line:hover {
            transform: scale(1.05);
            text-shadow: 0 0 20px rgba(255, 107, 107, 0.8);
        }

        .heart {
            display: block;
            margin: 25px 0;
            font-size: 2em;
            text-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
            animation: heartbeat 1.5s infinite ease-in-out;
            color: #ff4d4d;
            position: relative;
            width: 1em;
            margin-left: auto;
            margin-right: auto;
            transition: opacity 0.5s ease;
        }

        .heart::before,
        .heart::after {
            content: '❤';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            opacity: 0.2;
            animation: heart-echo 1.5s infinite ease-out;
            pointer-events: none;
        }

        .heart::before {
            animation-delay: 0.2s;
        }

        .heart::after {
            animation-delay: 0.4s;
        }

        @keyframes heart-echo {
            0% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.2;
            }

            100% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes heartbeat {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes fall {
            from {
                transform: translateY(-10px) rotate(0deg);
            }

            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            background: rgba(255, 107, 107, 0.5);
            border-radius: 50%;
            pointer-events: none;
            animation: float 3s infinite ease-in-out;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0) translateX(0);
            }

            50% {
                transform: translateY(-20px) translateX(10px);
            }
        }

        .message>div:last-child {
            margin-top: 20px;
            animation: glow 2s infinite alternate;
            font-weight: bold;
            opacity: 0.8;
            color: rgba(255, 77, 77, 0.9);
        }

        @keyframes glow {
            from {
                text-shadow: 0 0 2px #fff, 0 0 4px #fff, 0 0 6px rgba(255, 77, 77, 0.7), 0 0 8px rgba(255, 77, 77, 0.5);
            }

            to {
                text-shadow: 0 0 3px #fff, 0 0 5px #fff, 0 0 7px rgba(255, 77, 77, 0.7), 0 0 9px rgba(255, 77, 77, 0.5);
            }
        }

        .mouse-trail {
            position: fixed;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: screen;
            background: radial-gradient(circle, #ff4d4d 0%, transparent 70%);
            animation: trail-fade 1s linear forwards;
        }

        @keyframes trail-fade {
            from {
                transform: scale(1);
                opacity: 1;
            }

            to {
                transform: scale(0);
                opacity: 0;
            }
        }

        .poem-line {
            position: relative;
            padding: 5px 15px;
        }

        .poem-line::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 107, 107, 0.1);
            transform: scaleX(0);
            transform-origin: right;
            transition: transform 0.5s ease;
        }

        .poem-line:hover::before {
            transform: scaleX(1);
            transform-origin: left;
        }

        .firework {
            position: fixed;
            pointer-events: none;
            z-index: 999;
        }

        .firework-particle {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: explode 1.5s ease-out forwards;
            box-shadow: 0 0 15px currentColor, 0 0 30px currentColor;
            filter: blur(0.5px);
        }

        @keyframes explode {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }

            50% {
                opacity: 1;
                transform: translateY(calc(var(--ty) * 0.5)) translateX(calc(var(--tx) * 0.5)) scale(1.2);
            }

            100% {
                transform: translateY(var(--ty)) translateX(var(--tx)) scale(0);
                opacity: 0;
            }
        }

        .floating-emoji {
            position: fixed;
            font-size: 30px;
            pointer-events: none;
            z-index: 100;
            animation: floatEmoji 4s linear forwards;
            opacity: 0.8;
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.3));
        }

        @keyframes floatEmoji {
            0% {
                transform: translateY(100vh) rotate(0deg) scale(0.8);
                opacity: 0;
            }

            10% {
                opacity: 0.8;
            }

            90% {
                opacity: 0.8;
            }

            100% {
                transform: translateY(-50px) rotate(360deg) scale(0.4);
                opacity: 0;
            }
        }


        .clock {
            position: fixed;
            bottom: 20px;
            right: 20px;
            font-size: 1.8em;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 0 15px rgba(255, 107, 107, 0.7);
            font-family: "楷体", KaiTi, "华文楷体", STKaiti, serif;
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 25px;
            border-radius: 25px;
            backdrop-filter: blur(8px);
            animation: fadeIn 1s ease-out;
            z-index: 1000;
        }

        .petal {
            position: fixed;
            pointer-events: none;
            z-index: 1;
            animation: falling 10s linear infinite;
            color: #ff69b4;
            opacity: 0.7;
            text-shadow: 0 0 5px rgba(255, 105, 180, 0.5);
        }

        @keyframes falling {
            0% {
                transform: translate(var(--startX), -10%) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 0.7;
            }

            100% {
                transform: translate(var(--endX), 110%) rotate(720deg);
                opacity: 0;
            }
        }

        .snake {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
        }

        .snake-segment {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #fff, var(--color));
            box-shadow: 0 0 20px var(--color);
            opacity: 0.9;
            will-change: transform;
            transform: translate(-50%, -50%);
        }


        .secret-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3em;
            color: #fff;
            text-shadow: 0 0 10px #ff0000;
            z-index: 10000;
            opacity: 0;
            transition: all 2s ease;
            font-family: "楷体", KaiTi, "华文楷体", STKaiti, serif;
        }

        .secret-message .heart {
            display: inline-block;
            animation: secretHeart 1.5s infinite;
            color: #ff4d4d;
            filter: drop-shadow(0 0 15px rgba(255, 0, 0, 0.8));
        }

        @keyframes secretHeart {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.3);
            }
        }

        // 添加星空样式
        .starry-sky {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: #fff;
            border-radius: 50%;
            animation: twinkle var(--duration) ease-in-out infinite;
            opacity: 0;
            filter: blur(0.5px);
            box-shadow: 0 0 4px #fff;
        }

        @keyframes twinkle {
            0%, 100% {
                opacity: 0.1;
                transform: scale(0.3);
                filter: brightness(0.5);
            }
            50% {
                opacity: var(--brightness);
                transform: scale(1.2);
                filter: brightness(1.5);
            }
        }

        // 添加流星效果
        .shooting-star {
            position: fixed;
            width: 6px;
            height: 6px;
            background: linear-gradient(to right, 
                rgba(255, 255, 255, 1) 0%,
                rgba(255, 255, 255, 0.9) 20%,
                rgba(255, 255, 255, 0.4) 60%,
                transparent 100%);
            transform-origin: left;
            opacity: 0;
            filter: blur(1.5px);
            box-shadow: 
                0 0 30px #fff,
                0 0 50px #fff,
                0 0 70px #fff;
            z-index: 1000;
        }

        @keyframes shoot {
            0% {
                opacity: 0;
                transform: translate(0, 0) rotate(var(--angle));
            }
            5% {
                opacity: 1;
            }
            95% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translate(var(--distance), var(--distance)) rotate(var(--angle));
            }
        }

        .firework-trail {
            position: fixed;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes riseUp {
            from {
                transform: translateY(0);
                opacity: 1;
            }

            to {
                transform: translateY(var(--height));
                opacity: 0;
            }
        }

        .countdown {
            position: fixed;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            text-align: center;
            font-family: "楷体", KaiTi, "华文楷体", STKaiti, serif;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.7);
        }

        .countdown-text {
            font-size: 2em;
            margin-bottom: 20px;
        }

        .countdown-numbers {
            font-size: 3em;
        }

        .countdown-numbers span {
            display: inline-block;
            min-width: 70px;
            padding: 0 10px;
            margin: 0 5px;
            background: rgba(255, 107, 107, 0.2);
            border-radius: 10px;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .music-player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            font-size: 2em;
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.7);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .music-player:hover {
            transform: rotate(360deg);
        }

        .music-player.playing {
            color: #ff6b6b;
        }

        .music-player.paused {
            color: #fff;
        }

        .flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fff;
            opacity: 0;
            pointer-events: none;
            z-index: 9999;
            animation: flash 1s ease-in-out forwards;
        }

        @keyframes flash {
            0% {
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        .firework-spiral {
            position: fixed;
            pointer-events: none;
            z-index: 999;
        }

        .firework-spiral-particle {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: spiral 2s linear infinite;
            box-shadow: 0 0 15px currentColor, 0 0 30px currentColor;
            filter: blur(0.5px);
        }

        @keyframes spiral {
            0% {
                transform: translateY(0) rotate(0deg);
            }

            100% {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        .firework-trail {
            position: fixed;
            pointer-events: none;
            z-index: -1;
        }

        .firework-trail-particle {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: riseUp 3s linear infinite;
            box-shadow: 0 0 15px currentColor, 0 0 30px currentColor;
            filter: blur(0.5px);
        }

        @keyframes riseUp {
            from {
                transform: translateY(0);
                opacity: 1;
            }

            to {
                transform: translateY(var(--height));
                opacity: 0;
            }
        }

        .new-year-wish {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }

        .poem-line {
            margin: 12px 0;
            font-size: 1.2em;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
    </style>
</head>

<body>
    <audio id="bgMusic" loop>
        <source src="Martin Ermen - River Flows In You.mp3" type="audio/mpeg">
    </audio>
    <div class="particles"></div>
    <div class="clock"></div>
    <div class="countdown" style="display: none;">
        <div class="countdown-text">距离2025年还有</div>
        <div class="countdown-numbers">
            <span id="days">00</span>天
            <span id="hours">00</span>时
            <span id="minutes">00</span>分
            <span id="seconds">00</span>秒
        </div>
    </div>
    <div class="message">
        <div class="poem">
            <div class="poem-line" style="animation-delay: 0.5s">岁序更替 山河无恙</div>
            <div class="poem-line" style="animation-delay: 1s">愿你眉目如画 岁月胜花</div>
            <div class="poem-line" style="animation-delay: 1.5s">前程似锦 星光满路</div>
            <div class="poem-line" style="animation-delay: 2s">所愿皆成 所念皆如</div>
            <div class="poem-line" style="animation-delay: 2.5s">新年胜意 暖暖相围</div>
        </div>
        <span class="heart">✨</span>
        <div class="new-year-wish">
            <span style="font-size: 1.5em; margin-bottom: 10px;">新年快乐</span>
            <div style="font-size: 0.8em; opacity: 0.9; margin-top: 10px;">愿你所有的期待都能成真</div>
        </div>
    </div>

    <script>
        // 在脚本开始处添加变量声明
        let autoFireworksTimeout;

        // 添加飘落的雪花效果
        function createSnow() {
            const snow = document.createElement('div');
            snow.style.position = 'fixed';
            snow.style.top = '-10px';
            snow.style.left = Math.random() * window.innerWidth + 'px';
            snow.style.opacity = Math.random() * 0.8 + 0.2;
            snow.style.fontSize = Math.random() * 10 + 10 + 'px';
            snow.innerHTML = '❄';
            snow.style.color = 'white';
            snow.style.zIndex = '-1';
            snow.style.pointerEvents = 'none';

            const duration = Math.random() * 3 + 2;
            snow.style.animation = `fall ${duration}s linear`;

            document.body.appendChild(snow);
            setTimeout(() => snow.remove(), duration * 1000);
        }

        setInterval(createSnow, 500);

        // 添加粒子效果
        function createParticles() {
            const container = document.querySelector('.particles');
            const particleCount = 30;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';

                const size = Math.random() * 5 + 2;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';

                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 2 + 's';
                particle.style.opacity = Math.random() * 0.5;

                container.appendChild(particle);
            }
        }

        createParticles();

        // 修改鼠标轨迹效果，减少创建的DOM元素
        let lastTrailTime = 0;
        document.addEventListener('mousemove', function (e) {
            const now = Date.now();
            if (now - lastTrailTime < 50) return; // 限制创建频率
            lastTrailTime = now;

            const trail = document.createElement('div');
            trail.className = 'mouse-trail';
            trail.style.left = e.pageX - 5 + 'px';
            trail.style.top = e.pageY - 5 + 'px';
            document.body.appendChild(trail);

            setTimeout(() => trail.remove(), 500); // 减少持续时间
        });

        // 为"新年快乐"添加彩虹效果
        document.querySelector('.message > div:last-child').classList.add('rainbow-text');

        // 修改烟花相关代码
        function createFirework(x, y) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';

            const particles = 50;  // 减少粒子数量
            const colors = [
                '#ff0000', // 红色
                '#ffd700', // 金色
                '#ff69b4', // 粉红
                '#ff4500', // 橙红色
                '#ff8c00'  // 深橙色
            ];

            for (let i = 0; i < particles; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework-particle';

                const angle = (i / particles) * 360 + Math.random() * 20;
                const distance = Math.random() * 100 + 50;  // 减少扩散距离
                const rad = angle * Math.PI / 180;

                const tx = Math.cos(rad) * distance;
                const ty = Math.sin(rad) * distance;

                particle.style.setProperty('--tx', tx + 'px');
                particle.style.setProperty('--ty', ty + 'px');

                const color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.backgroundColor = color;
                particle.style.color = color;

                firework.appendChild(particle);
            }

            document.body.appendChild(firework);
            setTimeout(() => firework.remove(), 1000);  // 减少动画时间
        }

        // 优化自动烟花的频率
        function autoFireworks() {
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * (window.innerHeight * 0.6);
            createFirework(x, y);

            autoFireworksTimeout = setTimeout(autoFireworks, Math.random() * 1000 + 500);  // 降低频率
        }

        // 启动自动烟花
        setTimeout(autoFireworks, 1000);

        // 在现有脚本后添加表情符号效果
        const emojis = ['🎉', '✨', '🌟', '💫', '⭐', '🎊', '🎈', '🎆', '🎇', '🌸', '💝', '💖', '🏮', '🐉', '🍀'];

        function createFloatingEmoji() {
            const emoji = document.createElement('div');
            emoji.className = 'floating-emoji';
            emoji.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];

            // 随机水平位置
            emoji.style.left = Math.random() * window.innerWidth + 'px';
            // 随机大小
            emoji.style.fontSize = Math.random() * 20 + 25 + 'px';
            // 随机动画时间
            emoji.style.animationDuration = Math.random() * 2 + 3 + 's';

            document.body.appendChild(emoji);
            setTimeout(() => emoji.remove(), 5000);
        }

        // 修改创建频率
        setInterval(createFloatingEmoji, 500);

        // 添加时钟功能
        function updateClock() {
            const clock = document.querySelector('.clock');
            const now = new Date();

            const options = {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            };

            clock.textContent = now.toLocaleString('zh-CN', options).replace(/\//g, '-');
            requestAnimationFrame(updateClock);
        }

        updateClock();

        // 添加花瓣效果
        function createPetal() {
            const petals = ['🌸', '🌺', '🌹', '💮', '🏵️'];
            const petal = document.createElement('div');
            petal.className = 'petal';
            petal.innerHTML = petals[Math.floor(Math.random() * petals.length)];

            const startX = Math.random() * window.innerWidth;
            const drift = (Math.random() - 0.5) * 200;
            petal.style.setProperty('--startX', startX + 'px');
            petal.style.setProperty('--endX', (startX + drift) + 'px');
            petal.style.left = startX + 'px';
            petal.style.fontSize = Math.random() * 15 + 15 + 'px';

            document.body.appendChild(petal);
            setTimeout(() => petal.remove(), 10000);
        }

        // 定期创建花瓣
        setInterval(createPetal, 500);

        // 在脚本部分添加蛇的逻辑
        function createSnake() {
            const snake = document.createElement('div');
            snake.className = 'snake';
            document.body.appendChild(snake);

            const segments = [];
            const segmentCount = 20;
            const colors = [
                '#ff3333', '#ff6633', '#ff9933', '#ffcc33',
                '#ffff33', '#99ff33', '#33ff33', '#33ff99',
                '#33ffff', '#3399ff', '#3333ff', '#9933ff'
            ];

            // 初始化在屏幕中央
            const startX = window.innerWidth / 2;
            const startY = window.innerHeight / 2;

            // 创建蛇的段
            for (let i = 0; i < segmentCount; i++) {
                const segment = document.createElement('div');
                segment.className = 'snake-segment';
                segment.style.setProperty('--color', colors[i % colors.length]);
                snake.appendChild(segment);

                segments.push({
                    element: segment,
                    x: startX,
                    y: startY
                });
            }

            let time = 0;

            function updateSnake() {
                time += 0.003;

                // 计算中心点
                const centerX = window.innerWidth / 2;
                const centerY = window.innerHeight / 2;

                // 使用多个正弦波创造复杂的轨迹
                const radius = Math.min(window.innerWidth, window.innerHeight) * 0.2;
                const t1 = time * 0.7;  // 慢速旋转
                const t2 = time * 2;    // 快速波动
                const t3 = time * 0.3;  // 超慢速变化

                // 组合多个运动
                const x1 = Math.sin(t1) * radius * 0.8;
                const y1 = Math.cos(t1) * radius * 0.8;

                const x2 = Math.sin(t2) * radius * 0.3;
                const y2 = Math.cos(t2 * 1.5) * radius * 0.3;

                const x3 = Math.sin(t3) * radius * 0.2;
                const y3 = Math.cos(t3 * 2) * radius * 0.2;

                const targetX = centerX + x1 + x2 + x3;
                const targetY = centerY + y1 + y2 + y3;

                // 更新蛇的每个段
                segments.forEach((segment, index) => {
                    if (index === 0) {
                        // 头部平滑追踪
                        const dx = targetX - segment.x;
                        const dy = targetY - segment.y;
                        segment.x += dx * 0.08;
                        segment.y += dy * 0.08;
                    } else {
                        const prevSegment = segments[index - 1];
                        const dx = prevSegment.x - segment.x;
                        const dy = prevSegment.y - segment.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        const idealDistance = 12;

                        // 添加一些随机摆动
                        const wiggle = Math.sin(time * 5 + index * 0.5) * 0.3;
                        const angle = Math.atan2(dy, dx) + wiggle;

                        // 弹性跟随
                        const speed = 0.15 + Math.sin(time * 2 + index * 0.2) * 0.05;
                        segment.x += dx * speed;
                        segment.y += dy * speed;
                    }

                    // 更新视觉效果
                    const scale = 1 - index * 0.02;
                    const breathe = 1 + Math.sin(time * 3 + index * 0.2) * 0.05; // 添加呼吸效果
                    segment.element.style.left = `${segment.x}px`;
                    segment.element.style.top = `${segment.y}px`;
                    segment.element.style.transform = `translate(-50%, -50%) scale(${scale * breathe})`;
                    segment.element.style.opacity = 1 - (index / segmentCount) * 0.3;
                });

                requestAnimationFrame(updateSnake);
            }

            updateSnake();
        }

        // 创建蛇
        createSnake();

        // 添加一个特殊的键盘组合触发彩蛋
        let konami = '';
        const konamiCode = 'ArrowUpArrowUpArrowDownArrowDownArrowLeftArrowRightArrowLeftArrowRightba';

        document.addEventListener('keydown', (e) => {
            konami += e.key;
            if (konami.length > konamiCode.length) {
                konami = konami.substr(konami.length - konamiCode.length);
            }

            if (konami === konamiCode) {
                // 触发彩蛋效果
                activateSecretMode();
                konami = '';
            }
        });

        // 修改彩蛋触发函数
        function activateSecretMode() {
            // 获取元素
            const message = document.querySelector('.message');
            const messages = document.querySelectorAll('.poem-line');
            const heart = document.querySelector('.heart');

            // 淡出所有元素
            message.style.opacity = '0';

            // 等待淡出完成后显示秘密消息
            setTimeout(() => {
                // 创建并显示秘密消息
                const secret = document.createElement('div');
                secret.className = 'secret-message';
                secret.style.position = 'fixed';
                secret.style.top = '50%';
                secret.style.left = '50%';
                secret.style.transform = 'translate(-50%, -50%) scale(0.8)';
                secret.style.fontSize = '3em';
                secret.style.color = '#fff';
                secret.style.textShadow = '0 0 10px rgba(255, 77, 77, 0.7)';
                secret.style.opacity = '0';
                secret.style.transition = 'all 1s ease';
                secret.style.zIndex = '10000';
                secret.style.textAlign = 'center';

                const text = document.createElement('div');
                text.innerHTML = '我喜欢你 <br>';
                text.style.marginBottom = '20px';

                const subText = document.createElement('div');
                subText.textContent = '';
                subText.style.fontSize = '0.6em';
                subText.style.opacity = '0.8';
                subText.style.fontWeight = 'lighter';
                subText.style.letterSpacing = '3px';

                const heartIcon = document.createElement('span');
                heartIcon.className = 'secret-heart';
                heartIcon.textContent = '♥';
                heartIcon.style.fontSize = '0.8em';
                heartIcon.style.margin = '0 10px';
                heartIcon.style.color = '#ffd700';
                heartIcon.style.textShadow = '0 0 15px rgba(255, 215, 0, 0.8)';

                secret.appendChild(text);
                secret.appendChild(subText);
                document.body.appendChild(secret);

                // 显示秘密消息和特效
                requestAnimationFrame(() => {
                    secret.style.opacity = '1';
                    secret.style.transform = 'translate(-50%, -50%) scale(1)';

                    // 增加烟花数量和持续时间
                    const burstCount = 30; // 从20增加到30
                    for (let i = 0; i < burstCount; i++) {
                        setTimeout(() => {
                            // 随机位置偏移
                            const angle = (i / burstCount) * Math.PI * 2;
                            const baseDistance = Math.min(window.innerWidth, window.innerHeight) * 0.3;
                            const randomOffset = Math.random() * 100 - 50; // 添加随机偏移
                            const distance = baseDistance + randomOffset;

                            const x = window.innerWidth / 2 + Math.cos(angle) * distance;
                            const y = window.innerHeight / 2 + Math.sin(angle) * distance;

                            // 每个位置创建多个烟花
                            const burstSize = Math.random() > 0.7 ? 2 : 1; // 30%概率创建双重烟花
                            for (let j = 0; j < burstSize; j++) {
                                setTimeout(() => {
                                    createStarBurst(
                                        x + (Math.random() * 40 - 20),
                                        y + (Math.random() * 40 - 20)
                                    );
                                }, j * 100);
                            }
                        }, i * 100); // 缩短间隔从120ms到100ms
                    }

                    // 增加漂浮星星数量
                    for (let i = 0; i < 50; i++) { // 从40增加到50
                        setTimeout(() => createFloatingStar(), i * 50); // 缩短间隔从60ms到50ms
                    }
                });

                // 4秒后淡出秘密消息并恢复原始内容
                setTimeout(() => {
                    secret.style.opacity = '0';
                    secret.style.transform = 'translate(-50%, -50%) scale(0.8)';

                    setTimeout(() => {
                        secret.remove();
                        message.style.opacity = '1';
                    }, 1000);
                }, 6000);
            }, 500);
        }

        // 修改星星爆发特效
        function createStarBurst(x, y) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';

            // 减少粒子数量，但增加大小和亮度保持视觉效果
            const particles = 16; // 从32减少到16
            const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#ff1493'];  // 减少颜色数量

            for (let i = 0; i < particles; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework-particle';
                particle.innerHTML = '♥';
                particle.style.fontSize = Math.random() * 20 + 15 + 'px'; // 增大尺寸

                const angle = (i / particles) * Math.PI * 2;
                const distance = Math.random() * 80 + 40;
                const tx = Math.cos(angle) * distance;
                const ty = Math.sin(angle) * distance;

                particle.style.setProperty('--tx', tx + 'px');
                particle.style.setProperty('--ty', ty + 'px');
                particle.style.color = colors[i % colors.length];

                firework.appendChild(particle);
            }

            document.body.appendChild(firework);
            setTimeout(() => firework.remove(), 1500);
        }

        // 添加漂浮的星星效果
        function createFloatingStar() {
            const star = document.createElement('div');
            star.className = 'floating-heart'; // 复用现有的动画类
            star.innerHTML = '♥';
            star.style.position = 'fixed';
            star.style.left = Math.random() * window.innerWidth + 'px';
            star.style.top = window.innerHeight + 'px';
            star.style.color = `hsl(${Math.random() * 30 + 45}, 100%, 70%)`; // 金黄色系
            star.style.fontSize = Math.random() * 15 + 15 + 'px';
            star.style.animation = `floatUp ${Math.random() * 2 + 3}s ease-out forwards`;
            star.style.textShadow = '0 0 10px rgba(255, 215, 0, 0.8)';

            document.body.appendChild(star);
            setTimeout(() => star.remove(), 5000);
        }

        // 创建星空效果
        function createStarrySky() {
            const sky = document.createElement('div');
            sky.className = 'starry-sky';
            document.body.appendChild(sky);

            // 增加星星数量和多样性
            for (let i = 0; i < 300; i++) { // 从200增加到300
                const star = document.createElement('div');
                star.className = 'star';

                // 随机大小和位置
                const size = Math.random() * 3 + 1; // 增加星星最大尺寸
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';

                // 随机颜色
                const hue = Math.random() * 60 - 30 + 60; // 黄色系
                const saturation = Math.random() * 30 + 70; // 70-100%
                const lightness = Math.random() * 30 + 70; // 70-100%
                star.style.backgroundColor = `hsl(${hue}, ${saturation}%, ${lightness}%)`;
                star.style.boxShadow = `0 0 ${size * 2}px hsl(${hue}, ${saturation}%, ${lightness}%)`;

                // 随机动画参数
                star.style.setProperty('--duration', Math.random() * 4 + 2 + 's');
                star.style.setProperty('--brightness', Math.random() * 0.7 + 0.3);
                star.style.animationDelay = Math.random() * 4 + 's';

                sky.appendChild(star);
            }

            // 增加流星频率和效果
            setInterval(() => {
                if (Math.random() > 0.3) { // 增加出现概率到70%
                    const shootingStar = document.createElement('div');
                    shootingStar.className = 'shooting-star';

                    // 设置流星参数
                    const angle = Math.random() * 20 - 45; // -45到-25度之间
                    const distance = Math.random() * 1000 + 800; // 增加流星划过的距离
                    const duration = Math.random() * 0.6 + 0.4; // 加快速度
                    const length = Math.random() * 300 + 200; // 增加流星长度
                    
                    // 随机起始位置，但保证从屏幕上方开始
                    const startX = Math.random() * (window.innerWidth + 500) - 200;
                    const startY = -50; // 从更高的位置开始

                    shootingStar.style.left = startX + 'px';
                    shootingStar.style.top = startY + 'px';
                    shootingStar.style.setProperty('--angle', angle + 'deg');
                    shootingStar.style.setProperty('--distance', distance + 'px');
                    shootingStar.style.setProperty('--duration', duration + 's');
                    shootingStar.style.setProperty('--length', length + 'px');

                    document.body.appendChild(shootingStar);
                    setTimeout(() => shootingStar.remove(), duration * 1000);
                }
            }, 500); // 更频繁的流星
        }

        // 创建星空
        createStarrySky();

        // 添加持续的背景烟花效果
        function createBackgroundFireworks() {
            // 减少创建频率
            setTimeout(createBackgroundFireworks, Math.random() * 1000 + 800); // 增加间隔

            // 随机决定是否创建，控制密度
            if (Math.random() > 0.7) return;

            const x = Math.random() * window.innerWidth;
            const y = Math.random() * (window.innerHeight * 0.7);
            createBackgroundBurst(x, y);
        }

        // 背景烟花爆炸效果
        function createBackgroundBurst(x, y) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            firework.style.zIndex = '-1'; // 确保在背景层

            const colors = [
                '#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1',
                '#96f7d2', '#f7d794', '#f8a5c2', '#778beb'
            ];

            const particles = 20;
            for (let i = 0; i < particles; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework-particle';

                // 随机使用不同的形状
                const shapes = ['✦', '✬', '⭐', '✶', '●'];
                particle.innerHTML = shapes[Math.floor(Math.random() * shapes.length)];
                particle.style.fontSize = Math.random() * 8 + 6 + 'px'; // 背景烟花稍小

                const angle = (i / particles) * Math.PI * 2;
                const distance = Math.random() * 60 + 30; // 爆炸范围稍小
                const tx = Math.cos(angle) * distance;
                const ty = Math.sin(angle) * distance;

                particle.style.setProperty('--tx', tx + 'px');
                particle.style.setProperty('--ty', ty + 'px');
                particle.style.color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.opacity = '0.6'; // 降低背景烟花的不透明度

                firework.appendChild(particle);
            }

            document.body.appendChild(firework);
            setTimeout(() => firework.remove(), 1500);
        }

        // 在页面加载时启动背景烟花
        window.addEventListener('load', () => {
            // 尝试自动播放
            bgMusic.play().catch(() => {
                console.log('等待用户交互后播放音乐...');
            });

            // 如果自动播放失败，监听任意点击事件来播放
            document.addEventListener('click', function playOnFirstClick() {
                bgMusic.play();
                document.removeEventListener('click', playOnFirstClick);
            }, { once: true });

            // 其他初始化代码...
            const now = new Date();
            if (now >= targetDate) {
                countdown.style.display = 'none';
                message.style.display = 'block';
                createBackgroundFireworks();
            } else {
                message.style.display = 'none';
                countdown.style.display = 'block';
                updateCountdown();
            }
        });

        // 获取音频元素
        const bgMusic = document.getElementById('bgMusic');

        // 设置音量
        bgMusic.volume = 0.3; // 音量设为 30%

        // 添加音乐控制按钮
        const musicBtn = document.createElement('div');
        musicBtn.className = 'music-control';
        musicBtn.innerHTML = '🎵';
        musicBtn.style.position = 'fixed';
        musicBtn.style.top = '20px';
        musicBtn.style.left = '20px';
        musicBtn.style.fontSize = '24px';
        musicBtn.style.color = '#fff';
        musicBtn.style.cursor = 'pointer';
        musicBtn.style.zIndex = '1000';
        musicBtn.style.textShadow = '0 0 10px rgba(255, 255, 255, 0.8)';
        musicBtn.style.transition = 'transform 0.3s ease';

        // 添加动画样式
        const style = document.createElement('style');
        style.textContent = `
            .music-control {
                animation: rotate 3s linear infinite;
            }
            .music-control.paused {
                animation-play-state: paused;
                opacity: 0.6;
            }
            @keyframes rotate {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);

        // 添加点击事件
        musicBtn.addEventListener('click', () => {
            if (bgMusic.paused) {
                bgMusic.play();
                musicBtn.classList.remove('paused');
            } else {
                bgMusic.pause();
                musicBtn.classList.add('paused');
            }
        });

        document.body.appendChild(musicBtn);

        // 获取元素
        const message = document.querySelector('.message');
        const countdown = document.querySelector('.countdown');

        // 设置目标时间
        const targetDate = new Date('2025-01-01T00:00:00');

        // 更新倒计时
        function updateCountdown() {
            try {
                const now = new Date();
                const diff = targetDate - now;

                if (isNaN(diff)) {
                    console.error('Invalid date calculation');
                    return;
                }

                if (diff <= 0) {
                    // 创建一个闪光效果
                    const flash = document.createElement('div');
                    flash.style.position = 'fixed';
                    flash.style.top = '0';
                    flash.style.left = '0';
                    flash.style.width = '100%';
                    flash.style.height = '100%';
                    flash.style.backgroundColor = 'white';
                    flash.style.opacity = '0';
                    flash.style.zIndex = '9999';
                    flash.style.transition = 'opacity 0.5s ease-out';
                    document.body.appendChild(flash);

                    // 触发闪光
                    requestAnimationFrame(() => {
                        flash.style.opacity = '0.8';
                        setTimeout(() => {
                            flash.style.opacity = '0';
                            setTimeout(() => flash.remove(), 500);
                        }, 100);
                    });

                    // 隐藏倒计时
                    countdown.style.opacity = '0';
                    countdown.style.transform = 'scale(1.5)';
                    countdown.style.transition = 'all 0.5s ease-out';

                    // 延迟显示祝福内容
                    setTimeout(() => {
                        countdown.style.display = 'none';
                        message.style.display = 'block';
                        message.style.opacity = '0';
                        message.style.transform = 'scale(0.8)';

                        requestAnimationFrame(() => {
                            message.style.opacity = '1';
                            message.style.transform = 'scale(1)';
                            message.style.transition = 'all 1s ease-out';
                        });

                        // 开始播放音乐
                        bgMusic.play().catch(() => { });

                        // 减少初始烟花数量但增加大小
                        const burstCount = 30; // 从50减少到30
                        for (let i = 0; i < burstCount; i++) {
                            setTimeout(() => {
                                const x = Math.random() * window.innerWidth;
                                const y = Math.random() * window.innerHeight * 0.8;
                                createStarBurst(x, y);

                                // 只在关键位置创建多重烟花
                                if (i % 5 === 0) {
                                    setTimeout(() => {
                                        createStarBurst(
                                            x + (Math.random() * 60 - 30),
                                            y + (Math.random() * 60 - 30)
                                        );
                                    }, 100);
                                }
                            }, i * 120);
                        }

                        createSpiralFireworks();
                        createBackgroundFireworks();
                    }, 600);

                    return;
                }

                // 计算剩余时间
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);

                // 更新显示
                document.getElementById('days').textContent = String(days).padStart(2, '0');
                document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
                document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');

                // 继续倒计时
                requestAnimationFrame(updateCountdown);
            } catch (error) {
                console.error('Error in countdown:', error);
                // 发生错误时显示祝福内容作为后备方案
                countdown.style.display = 'none';
                message.style.display = 'block';
            }
        }

        // 添加螺旋烟花效果
        function createSpiralFireworks() {
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const rounds = 2; // 减少圈数
            const particlesPerRound = 15; // 减少每圈粒子数
            const radius = Math.min(window.innerWidth, window.innerHeight) * 0.3;

            for (let round = 0; round < rounds; round++) {
                for (let i = 0; i < particlesPerRound; i++) {
                    const angle = (i / particlesPerRound) * Math.PI * 2;
                    const delay = (round * particlesPerRound + i) * 60;
                    const currentRadius = radius * (1 - round * 0.2);

                    setTimeout(() => {
                        const x = centerX + Math.cos(angle) * currentRadius;
                        const y = centerY + Math.sin(angle) * currentRadius;
                        createStarBurst(x, y);
                    }, delay);
                }
            }
        }

        // 添加鼠标点击特效和交互功能
        function addInteractiveFeatures() {
            // 1. 点击创建烟花效果
            document.addEventListener('click', (e) => {
                if (e.target.tagName !== 'BUTTON') { // 不是按钮时才触发
                    createStarBurst(e.clientX, e.clientY);
                }
            });

            // 2. 添加交互按钮组
            const buttonContainer = document.createElement('div');
            buttonContainer.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 20px;
                display: flex;
                gap: 10px;
                z-index: 1000;
                flex-wrap: wrap;
                max-width: 80vw;
            `;

            // 创建按钮样式
            const buttonStyle = `
                background: rgba(255, 255, 255, 0.1);
                border: 1px solid rgba(255, 255, 255, 0.2);
                color: white;
                padding: 8px 15px;
                border-radius: 20px;
                cursor: pointer;
                font-family: "楷体";
                backdrop-filter: blur(5px);
                transition: all 0.3s ease;
                font-size: 14px;
                text-shadow: 0 0 10px rgba(255, 107, 107, 0.7);
            `;

            // 添加按钮
            const buttons = [
                {
                    text: '✨ 流星雨',
                    onClick: createMeteorShower
                },
                {
                    text: '🎆 烟花秀',
                    onClick: createFireworkShow
                },
                {
                    text: '💫 星光闪烁',
                    onClick: twinkleStars
                },
                {
                    text: '🌈 彩虹特效',
                    onClick: createRainbowEffect
                },
                {
                    text: '🎨 变色模式',
                    onClick: toggleColorMode
                },
                {
                    text: '🎯 打靶游戏',
                    onClick: startTargetGame
                }
            ];

            buttons.forEach(btn => {
                const button = document.createElement('button');
                button.innerHTML = btn.text;
                button.style.cssText = buttonStyle;
                button.addEventListener('mouseover', () => {
                    button.style.transform = 'scale(1.1)';
                    button.style.background = 'rgba(255, 255, 255, 0.2)';
                });
                button.addEventListener('mouseout', () => {
                    button.style.transform = 'scale(1)';
                    button.style.background = 'rgba(255, 255, 255, 0.1)';
                });
                button.addEventListener('click', btn.onClick);
                buttonContainer.appendChild(button);
            });

            document.body.appendChild(buttonContainer);
        }

        // 流星雨效果
        function createMeteorShower() {
            const count = 50; // 从30增加到50
            let created = 0;
            
            // 清除之前的流星
            document.querySelectorAll('.shooting-star').forEach(star => star.remove());
            
            const interval = setInterval(() => {
                if (created >= count) {
                    clearInterval(interval);
                    return;
                }

                // 同时创建多个流星
                const createCount = Math.random() > 0.7 ? 2 : 1; // 30%概率同时创建2个
                for(let i = 0; i < createCount; i++) {
                    if (created >= count) break;

                    const shootingStar = document.createElement('div');
                    shootingStar.className = 'shooting-star';
                    
                    const startX = Math.random() * (window.innerWidth + 300) - 150;
                    const startY = -100;
                    
                    const angle = Math.random() * 30 - 45;
                    const distance = Math.random() * 1000 + 600; // 增加划过距离
                    const duration = Math.random() * 1.2 + 0.8;
                    
                    shootingStar.style.cssText = `
                        left: ${startX}px;
                        top: ${startY}px;
                        position: fixed;
                        width: 6px;
                        height: 6px;
                        opacity: 0;
                        z-index: 1000;
                        background: linear-gradient(to right, 
                            rgba(255, 255, 255, 1) 0%,
                            rgba(255, 255, 255, 0.9) 20%,
                            rgba(255, 255, 255, 0.4) 60%,
                            transparent 100%);
                        box-shadow: 
                            0 0 30px #fff,
                            0 0 50px #fff,
                            0 0 70px #fff;
                        transform-origin: left;
                    `;
                    
                    shootingStar.style.setProperty('--angle', angle + 'deg');
                    shootingStar.style.setProperty('--distance', distance + 'px');
                    
                    document.body.appendChild(shootingStar);
                    
                    requestAnimationFrame(() => {
                        shootingStar.style.animation = `shoot ${duration}s linear forwards`;
                    });
                    
                    setTimeout(() => shootingStar.remove(), duration * 1000 + 100);
                    created++;
                }
            }, 100); // 缩短间隔从150ms到100ms
        }

        // 烟花秀效果
        function createFireworkShow() {
            const duration = 3000; // 持续3秒
            const interval = setInterval(() => {
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * (window.innerHeight * 0.6);
                createStarBurst(x, y);
            }, 200);

            setTimeout(() => clearInterval(interval), duration);
        }

        // 星光闪烁效果
        function twinkleStars() {
            const stars = document.querySelectorAll('.star');
            stars.forEach(star => {
                // 随机大小
                const size = Math.random() * 4 + 2;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                
                // 随机颜色
                const colors = ['#fff', '#ffd700', '#ffb6c1', '#87ceeb'];
                const color = colors[Math.floor(Math.random() * colors.length)];
                star.style.background = color;
                star.style.boxShadow = `0 0 ${size * 2}px ${color}`;
                
                // 重置动画
                star.style.animation = 'none';
                star.offsetHeight;
                
                // 设置新的动画参数
                const duration = Math.random() * 3 + 2;
                star.style.animation = `twinkle ${duration}s ease-in-out infinite`;
                star.style.setProperty('--brightness', Math.random() * 0.5 + 0.5);
                
                // 添加闪烁效果
                star.style.transition = 'all 0.3s ease';
            });
        }

        // 初始化交互功能
        addInteractiveFeatures();

        // 添加更多交互按钮和效果
        const additionalButtons = [
            {
                text: '🌈 彩虹特效',
                onClick: createRainbowEffect
            },
            {
                text: '🎨 变色模式',
                onClick: toggleColorMode
            },
            {
                text: '🎯 打靶游戏',
                onClick: startTargetGame
            }
        ];

        // 彩虹特效
        function createRainbowEffect() {
            const rainbow = document.createElement('div');
            rainbow.style.cssText = `
                position: fixed;
                width: 200vw;
                height: 200vh;
                left: 50%;
                bottom: -50vh;
                transform: translateX(-50%);
                background: radial-gradient(ellipse at 50% 100%,
                    transparent 40%,
                    rgba(255,0,0,0.2) 41%, rgba(255,0,0,0.2) 43%,
                    rgba(255,165,0,0.2) 44%, rgba(255,165,0,0.2) 46%,
                    rgba(255,255,0,0.2) 47%, rgba(255,255,0,0.2) 49%,
                    rgba(0,255,0,0.2) 50%, rgba(0,255,0,0.2) 52%,
                    rgba(0,255,255,0.2) 53%, rgba(0,255,255,0.2) 55%,
                    rgba(0,0,255,0.2) 56%, rgba(0,0,255,0.2) 58%,
                    rgba(238,130,238,0.2) 59%, rgba(238,130,238,0.2) 61%,
                    transparent 62%);
                filter: blur(5px);
                opacity: 0;
                transition: opacity 1s ease;
                pointer-events: none;
                z-index: -1;
            `;
            document.body.appendChild(rainbow);
            requestAnimationFrame(() => rainbow.style.opacity = '1');
            setTimeout(() => {
                rainbow.style.opacity = '0';
                setTimeout(() => rainbow.remove(), 1000);
            }, 5000);
        }

        // 修改变色模式效果
        function toggleColorMode() {
            const colors = [
                '#ff6b6b', // 粉红色
                '#ffd700', // 金色
                '#4ecdc4', // 青色
                '#45b7d1', // 蓝色
                '#ff69b4', // 粉色
                '#9b59b6'  // 紫色
            ];
            let currentIndex = 0;
            const elements = document.querySelectorAll('.poem-line, .heart');
            
            // 增加颜色变化的动画效果
            elements.forEach(el => {
                el.style.transition = 'color 0.5s ease, text-shadow 0.5s ease';
            });
            
            // 更快的颜色切换速度
            const interval = setInterval(() => {
                elements.forEach(el => {
                    el.style.color = colors[currentIndex];
                    // 增强光晕效果
                    el.style.textShadow = `
                        0 0 10px ${colors[currentIndex]},
                        0 0 20px ${colors[currentIndex]},
                        0 0 30px ${colors[currentIndex]}
                    `;
                });
                
                // 添加缩放动画
                elements.forEach(el => {
                    el.style.transform = 'scale(1.1)';
                    setTimeout(() => {
                        el.style.transform = 'scale(1)';
                    }, 250);
                });
                
                currentIndex = (currentIndex + 1) % colors.length;
            }, 500); // 加快切换速度
            
            // 持续时间延长到15秒
            setTimeout(() => {
                clearInterval(interval);
                // 恢复原始样式
                elements.forEach(el => {
                    el.style.color = '';
                    el.style.textShadow = '';
                    el.style.transform = '';
                    el.style.transition = '';
                });
            }, 15000);
        }

        // 修改打靶游戏
        function startTargetGame() {
            // 检查是否已经有游戏在进行
            if (document.querySelector('.score-board')) {
                return; // 如果已有游戏在进行，直接返回
            }

            let score = 0;
            let targets = 0;
            const maxTargets = 10;
            let gameEnded = false; // 添加游戏结束标志
            
            // 创建计分板
            const scoreBoard = document.createElement('div');
            scoreBoard.className = 'score-board'; // 添加类名以便检查
            scoreBoard.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                color: white;
                font-size: 24px;
                text-shadow: 0 0 10px rgba(255,255,255,0.5);
                z-index: 1000;
            `;
            scoreBoard.textContent = `得分: ${score}/${maxTargets}`;
            document.body.appendChild(scoreBoard);
            
            function createTarget() {
                if (gameEnded) return; // 如果游戏已结束，不再创建新目标
                
                if (targets >= maxTargets) {
                    if (!gameEnded) { // 只在第一次达到目标数时显示提示
                        gameEnded = true;
                        setTimeout(() => {
                            alert(`游戏结束！\n最终得分: ${score}/${maxTargets}`);
                            scoreBoard.remove();
                        }, 500);
                    }
                    return;
                }
                
                const target = document.createElement('div');
                const size = Math.random() * 30 + 20;
                const x = Math.random() * (window.innerWidth - size);
                const y = Math.random() * (window.innerHeight - size);
                
                target.style.cssText = `
                    position: fixed;
                    left: ${x}px;
                    top: ${y}px;
                    width: ${size}px;
                    height: ${size}px;
                    background: radial-gradient(circle, #fff 0%, #ff6b6b 50%, transparent 70%);
                    border-radius: 50%;
                    cursor: pointer;
                    opacity: 0;
                    transition: all 0.3s ease;
                    z-index: 1000;
                `;
                
                document.body.appendChild(target);
                requestAnimationFrame(() => target.style.opacity = '1');
                
                target.onclick = () => {
                    if (gameEnded) return; // 如果游戏已结束，不再响应点击
                    score++;
                    scoreBoard.textContent = `得分: ${score}/${maxTargets}`;
                    createStarBurst(x + size/2, y + size/2);
                    target.remove();
                    setTimeout(createTarget, 500);
                };
                
                // 目标消失前检查游戏是否结束
                setTimeout(() => {
                    if (!gameEnded && target.parentNode) {
                        target.style.opacity = '0';
                        setTimeout(() => {
                            if (target.parentNode) target.remove();
                            if (!gameEnded) setTimeout(createTarget, 500);
                        }, 300);
                    }
                }, 2000);
                
                targets++;
            }
            
            createTarget();
        }

        // 将新按钮添加到现有按钮组
        buttons.push(...additionalButtons);

        // 修改蛇的运动效果
        function createSnakeTrail(e) {
            const snake = document.createElement('div');
            snake.className = 'snake';
            document.body.appendChild(snake);

            const segments = [];
            const segmentCount = 20;
            const colors = ['#ff6b6b', '#ff4757', '#ff3f34'];
            const baseSize = 15;

            // 创建蛇的所有节段
            for (let i = 0; i < segmentCount; i++) {
                const segment = document.createElement('div');
                segment.className = 'snake-segment';
                
                // 设置渐变大小和颜色
                const size = baseSize * (1 - i / segmentCount * 0.7);
                const colorIndex = Math.floor(i / (segmentCount / colors.length));
                const color = colors[Math.min(colorIndex, colors.length - 1)];
                
                segment.style.cssText = `
                    width: ${size}px;
                    height: ${size}px;
                    --color: ${color};
                    opacity: ${1 - i / segmentCount * 0.7};
                    filter: blur(${i / segmentCount * 2}px);
                    position: absolute;
                    border-radius: 50%;
                    background: radial-gradient(circle at 30% 30%, #fff, var(--color));
                    box-shadow: 0 0 20px var(--color);
                `;

                // 为第一个节段（头部）添加眼睛
                if (i === 0) {
                    // 左眼
                    const leftEye = document.createElement('div');
                    leftEye.style.cssText = `
                        position: absolute;
                        width: 4px;
                        height: 4px;
                        background: #000;
                        border-radius: 50%;
                        top: 25%;
                        left: 25%;
                        box-shadow: 0 0 2px #fff;
                    `;
                    segment.appendChild(leftEye);

                    // 右眼
                    const rightEye = document.createElement('div');
                    rightEye.style.cssText = `
                        position: absolute;
                        width: 4px;
                        height: 4px;
                        background: #000;
                        border-radius: 50%;
                        top: 25%;
                        right: 25%;
                        box-shadow: 0 0 2px #fff;
                    `;
                    segment.appendChild(rightEye);
                }
                
                snake.appendChild(segment);
                segments.push({
                    element: segment,
                    x: e.clientX,
                    y: e.clientY,
                    targetX: e.clientX,
                    targetY: e.clientY,
                    eyes: i === 0 ? {
                        left: leftEye,
                        right: rightEye
                    } : null
                });
            }

            let prevTime = performance.now();
            let isActive = true;

            function animate(currentTime) {
                if (!isActive) return;

                const deltaTime = (currentTime - prevTime) / 1000;
                prevTime = currentTime;

                segments[0].targetX = e.clientX;
                segments[0].targetY = e.clientY;

                segments.forEach((segment, index) => {
                    if (index === 0) {
                        segment.x += (segment.targetX - segment.x) * 15 * deltaTime;
                        segment.y += (segment.targetY - segment.y) * 15 * deltaTime;
                        
                        // 更新眼睛的朝向
                        if (segment.eyes) {
                            const dx = segment.targetX - segment.x;
                            const dy = segment.targetY - segment.y;
                            const angle = Math.atan2(dy, dx);
                            const eyeOffset = 2;
                            
                            segment.eyes.left.style.transform = `translate(${Math.cos(angle) * eyeOffset}px, ${Math.sin(angle) * eyeOffset}px)`;
                            segment.eyes.right.style.transform = `translate(${Math.cos(angle) * eyeOffset}px, ${Math.sin(angle) * eyeOffset}px)`;
                        }
                    } else {
                        const prev = segments[index - 1];
                        const spring = 12 - index * 0.3;
                        
                        segment.targetX = prev.x;
                        segment.targetY = prev.y;
                        
                        segment.x += (segment.targetX - segment.x) * spring * deltaTime;
                        segment.y += (segment.targetY - segment.y) * spring * deltaTime;
                    }

                    const wiggle = Math.sin(currentTime * 0.01 + index * 0.5) * (index * 0.5);
                    const x = segment.x + wiggle;
                    const y = segment.y;

                    segment.element.style.transform = `translate(${x}px, ${y}px)`;
                });

                requestAnimationFrame(animate);
            }

            requestAnimationFrame(animate);

            return () => {
                isActive = false;
                snake.remove();
            };
        }

        // 修改鼠标移动事件处理
        let currentSnake = null;
        document.addEventListener('mousemove', (e) => {
            if (!currentSnake) {
                currentSnake = createSnakeTrail(e);
            }
            e = {
                clientX: e.clientX,
                clientY: e.clientY
            };
        });

        // 当鼠标离开页面时清除蛇
        document.addEventListener('mouseleave', () => {
            if (currentSnake) {
                currentSnake();
                currentSnake = null;
            }
        });
    </script>
</body>
<!-- 小陆真可爱嘻嘻(*^▽^*) -->
</html>
