<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>新年祝福</title>
    <style>
        body {
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            font-family: "楷体", KaiTi, "华文楷体", STKaiti, serif;
        }

        .message {
            color: #ff6b6b;
            font-size: 2em;
            text-align: center;
            animation: fadeIn 3s ease-in;
            margin-top: 20vh;
            transition: opacity 0.5s ease;
        }

        .poem-line {
            opacity: 0;
            animation: fadeInUp 1s ease-out forwards;
            margin: 15px 0;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
            transition: all 0.5s ease;
            font-size: 1.2em;
            letter-spacing: 2px;
        }

        .poem-line:hover {
            transform: scale(1.05);
            text-shadow: 0 0 20px rgba(255, 107, 107, 0.8);
        }

        .heart {
            display: block;
            margin: 30px 0;
            font-size: 2em;
            text-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
            animation: heartbeat 1.5s infinite ease-in-out;
            color: #ff4d4d;
            position: relative;
            width: 1em;
            margin-left: auto;
            margin-right: auto;
            transition: opacity 0.5s ease;
        }

        .heart::before,
        .heart::after {
            content: '❤';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            opacity: 0.2;
            animation: heart-echo 1.5s infinite ease-out;
            pointer-events: none;
        }

        .heart::before {
            animation-delay: 0.2s;
        }

        .heart::after {
            animation-delay: 0.4s;
        }

        @keyframes heart-echo {
            0% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.2;
            }
            100% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0;
                transform: translateY(20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes heartbeat {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.2);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes fall {
            from {
                transform: translateY(-10px) rotate(0deg);
            }
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            background: rgba(255, 107, 107, 0.5);
            border-radius: 50%;
            pointer-events: none;
            animation: float 3s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) translateX(0);
            }
            50% {
                transform: translateY(-20px) translateX(10px);
            }
        }

        .message > div:last-child {
            margin-top: 20px;
            animation: glow 2s infinite alternate;
            font-weight: bold;
            opacity: 0.8;
            color: rgba(255, 77, 77, 0.9);
        }

        @keyframes glow {
            from {
                text-shadow: 0 0 2px #fff, 0 0 4px #fff, 0 0 6px rgba(255, 77, 77, 0.7), 0 0 8px rgba(255, 77, 77, 0.5);
            }
            to {
                text-shadow: 0 0 3px #fff, 0 0 5px #fff, 0 0 7px rgba(255, 77, 77, 0.7), 0 0 9px rgba(255, 77, 77, 0.5);
            }
        }

        .rainbow-text {
            background: linear-gradient(45deg, #ff4d4d, #ff9f1a, #ffff1a, #1aff1a, #1affff, #4d4dff, #ff4dff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: rainbow 8s linear infinite;
            background-size: 200% 200%;
        }

        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }

        .mouse-trail {
            position: fixed;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: screen;
            background: radial-gradient(circle, #ff4d4d 0%, transparent 70%);
            animation: trail-fade 1s linear forwards;
        }

        @keyframes trail-fade {
            from { transform: scale(1); opacity: 1; }
            to { transform: scale(0); opacity: 0; }
        }

        .poem-line {
            position: relative;
            padding: 5px 15px;
        }

        .poem-line::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 107, 107, 0.1);
            transform: scaleX(0);
            transform-origin: right;
            transition: transform 0.5s ease;
        }

        .poem-line:hover::before {
            transform: scaleX(1);
            transform-origin: left;
        }

        .firework {
            position: fixed;
            pointer-events: none;
            z-index: 999;
        }

        .firework-particle {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: explode 1.5s ease-out forwards;
            box-shadow: 0 0 15px currentColor, 0 0 30px currentColor;
            filter: blur(0.5px);
        }

        @keyframes explode {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            50% {
                opacity: 1;
                transform: translateY(calc(var(--ty) * 0.5)) translateX(calc(var(--tx) * 0.5)) scale(1.2);
            }
            100% {
                transform: translateY(var(--ty)) translateX(var(--tx)) scale(0);
                opacity: 0;
            }
        }

        .floating-emoji {
            position: fixed;
            font-size: 30px;
            pointer-events: none;
            z-index: 100;
            animation: floatEmoji 4s linear forwards;
            opacity: 0.8;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.3));
        }

        @keyframes floatEmoji {
            0% {
                transform: translateY(100vh) rotate(0deg) scale(0.8);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(-50px) rotate(360deg) scale(0.4);
                opacity: 0;
            }
        }

        
        .clock {
            position: fixed;
            bottom: 20px;
            right: 20px;
            font-size: 1.8em;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 0 15px rgba(255, 107, 107, 0.7);
            font-family: "楷体", KaiTi, "华文楷体", STKaiti, serif;
            background: rgba(0, 0, 0, 0.6);
            padding: 15px 25px;
            border-radius: 25px;
            backdrop-filter: blur(8px);
            animation: fadeIn 1s ease-out;
            z-index: 1000;
        }

        .petal {
            position: fixed;
            pointer-events: none;
            z-index: 1;
            animation: falling 10s linear infinite;
            color: #ff69b4;
            opacity: 0.7;
            text-shadow: 0 0 5px rgba(255, 105, 180, 0.5);
        }

        @keyframes falling {
            0% {
                transform: translate(var(--startX), -10%) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            100% {
                transform: translate(var(--endX), 110%) rotate(720deg);
                opacity: 0;
            }
        }

        .snake {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
        }

        .snake-segment {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #fff, var(--color));
            box-shadow: 0 0 20px var(--color);
            opacity: 0.9;
            will-change: transform;
            transform: translate(-50%, -50%);
        }

        
        .rainbow {
            position: fixed;
            left: 50%;
            bottom: -30vh;
            transform: translateX(-50%);
            width: 200vw;
            height: 200vh;
            pointer-events: none;
            z-index: -1;
            opacity: 0.15;
            background: 
                radial-gradient(
                    ellipse at 50% 100%,
                    transparent 40%,
                    #ff0000 41%, #ff0000 43%,
                    #ff8800 44%, #ff8800 46%,
                    #ffff00 47%, #ffff00 49%,
                    #00ff00 50%, #00ff00 52%,
                    #00ffff 53%, #00ffff 55%,
                    #0088ff 56%, #0088ff 58%,
                    #8800ff 59%, #8800ff 61%,
                    transparent 62%
                );
            filter: blur(5px);
            animation: rainbow-pulse 4s ease-in-out infinite;
        }

        @keyframes rainbow-pulse {
            0%, 100% { opacity: 0.12; }
            50% { opacity: 0.18; }
        }

        .secret-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3em;
            color: #fff;
            text-shadow: 0 0 10px #ff0000;
            z-index: 10000;
            opacity: 0;
            transition: all 2s ease;
            font-family: "楷体", KaiTi, "华文楷体", STKaiti, serif;
        }

        .secret-message .heart {
            display: inline-block;
            animation: secretHeart 1.5s infinite;
            color: #ff4d4d;
            filter: drop-shadow(0 0 15px rgba(255,0,0,0.8));
        }

        @keyframes secretHeart {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }

        // 添加星空样式
        .starry-sky {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -3;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: #fff;
            border-radius: 50%;
            animation: twinkle var(--duration) ease-in-out infinite;
            opacity: 0;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0; transform: scale(0.5); }
            50% { opacity: var(--brightness); transform: scale(1); }
        }

        // 添加流星效果
        .shooting-star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: linear-gradient(45deg, #fff, transparent);
            border-radius: 50%;
            animation: shoot var(--duration) linear forwards;
            opacity: 0;
            transform: rotate(var(--angle));
        }

        @keyframes shoot {
            0% { 
                opacity: 0;
                transform: rotate(var(--angle)) translateX(0) scale(1);
            }
            5% {
                opacity: var(--brightness);
            }
            95% {
                opacity: var(--brightness);
            }
            100% { 
                opacity: 0;
                transform: rotate(var(--angle)) translateX(var(--distance)) scale(0.2);
            }
        }

        .firework-trail {
            position: fixed;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes riseUp {
            from {
                transform: translateY(0);
                opacity: 1;
            }
            to {
                transform: translateY(var(--height));
                opacity: 0;
            }
        }
    </style>
</head>

<body>
    <div class="particles"></div>
    <div class="clock"></div>
    <div class="message">
        <div class="poem">
            <div class="poem-line" style="animation-delay: 0.5s">新岁初启，春风暖怀</div>
            <div class="poem-line" style="animation-delay: 1s">星光耀目，美好常随</div>
            <div class="poem-line" style="animation-delay: 1.5s">四时安稳，梦伴长怀</div>
            <div class="poem-line" style="animation-delay: 2s">心意托风，不语自欢</div>
        </div>
        <span class="heart">❤</span>
        <div>新年快乐</div>
    </div>

    <script>
        // 在脚本开始处添加变量声明
        let autoFireworksTimeout;

        // 添加飘落的雪花效果
        function createSnow() {
            const snow = document.createElement('div');
            snow.style.position = 'fixed';
            snow.style.top = '-10px';
            snow.style.left = Math.random() * window.innerWidth + 'px';
            snow.style.opacity = Math.random() * 0.8 + 0.2;
            snow.style.fontSize = Math.random() * 10 + 10 + 'px';
            snow.innerHTML = '❄';
            snow.style.color = 'white';
            snow.style.zIndex = '-1';
            snow.style.pointerEvents = 'none';
            
            const duration = Math.random() * 3 + 2;
            snow.style.animation = `fall ${duration}s linear`;
            
            document.body.appendChild(snow);
            setTimeout(() => snow.remove(), duration * 1000);
        }

        setInterval(createSnow, 500);

        // 添加粒子效果
        function createParticles() {
            const container = document.querySelector('.particles');
            const particleCount = 30;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                const size = Math.random() * 5 + 2;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 2 + 's';
                particle.style.opacity = Math.random() * 0.5;
                
                container.appendChild(particle);
            }
        }

        createParticles();

        // 修改鼠标轨迹效果，减少创建的DOM元素
        let lastTrailTime = 0;
        document.addEventListener('mousemove', function(e) {
            const now = Date.now();
            if (now - lastTrailTime < 50) return; // 限制创建频率
            lastTrailTime = now;
            
            const trail = document.createElement('div');
            trail.className = 'mouse-trail';
            trail.style.left = e.pageX - 5 + 'px';
            trail.style.top = e.pageY - 5 + 'px';
            document.body.appendChild(trail);
            
            setTimeout(() => trail.remove(), 500); // 减少持续时间
        });

        // 为"新年快乐"添加彩虹效果
        document.querySelector('.message > div:last-child').classList.add('rainbow-text');

        // 修改烟花相关代码
        function createFirework(x, y) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';

            const particles = 50;  // 减少粒子数量
            const colors = [
                '#ff0000', // 红色
                '#ffd700', // 金色
                '#ff69b4', // 粉红
                '#ff4500', // 橙红色
                '#ff8c00'  // 深橙色
            ];

            for (let i = 0; i < particles; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework-particle';
                
                const angle = (i / particles) * 360 + Math.random() * 20;
                const distance = Math.random() * 100 + 50;  // 减少扩散距离
                const rad = angle * Math.PI / 180;
                
                const tx = Math.cos(rad) * distance;
                const ty = Math.sin(rad) * distance;
                
                particle.style.setProperty('--tx', tx + 'px');
                particle.style.setProperty('--ty', ty + 'px');
                
                const color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.backgroundColor = color;
                particle.style.color = color;
                
                firework.appendChild(particle);
            }

            document.body.appendChild(firework);
            setTimeout(() => firework.remove(), 1000);  // 减少动画时间
        }

        // 优化自动烟花的频率
        function autoFireworks() {
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * (window.innerHeight * 0.6);
            createFirework(x, y);
            
            autoFireworksTimeout = setTimeout(autoFireworks, Math.random() * 1000 + 500);  // 降低频率
        }

        // 启动自动烟花
        setTimeout(autoFireworks, 1000);

        // 在现有脚本后添加表情符号效果
        const emojis = ['🎉', '✨', '🌟', '💫', '⭐', '🎊', '🎈', '🎆', '🎇', '🌸', '💝', '💖', '🏮', '🐉', '🍀'];
        
        function createFloatingEmoji() {
            const emoji = document.createElement('div');
            emoji.className = 'floating-emoji';
            emoji.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
            
            // 随机水平位置
            emoji.style.left = Math.random() * window.innerWidth + 'px';
            // 随机大小
            emoji.style.fontSize = Math.random() * 20 + 25 + 'px';
            // 随机动画时间
            emoji.style.animationDuration = Math.random() * 2 + 3 + 's';
            
            document.body.appendChild(emoji);
            setTimeout(() => emoji.remove(), 5000);
        }

        // 修改创建频率
        setInterval(createFloatingEmoji, 500);

        // 添加时钟功能
        function updateClock() {
            const clock = document.querySelector('.clock');
            const now = new Date();
            
            const options = {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            };
            
            clock.textContent = now.toLocaleString('zh-CN', options).replace(/\//g, '-');
            requestAnimationFrame(updateClock);
        }

        updateClock();

        // 添加花瓣效果
        function createPetal() {
            const petals = ['🌸', '🌺', '🌹', '💮', '🏵️'];
            const petal = document.createElement('div');
            petal.className = 'petal';
            petal.innerHTML = petals[Math.floor(Math.random() * petals.length)];
            
            const startX = Math.random() * window.innerWidth;
            const drift = (Math.random() - 0.5) * 200;
            petal.style.setProperty('--startX', startX + 'px');
            petal.style.setProperty('--endX', (startX + drift) + 'px');
            petal.style.left = startX + 'px';
            petal.style.fontSize = Math.random() * 15 + 15 + 'px';
            
            document.body.appendChild(petal);
            setTimeout(() => petal.remove(), 10000);
        }

        // 定期创建花瓣
        setInterval(createPetal, 500);

        // 在脚本部分添加蛇的逻辑
        function createSnake() {
            const snake = document.createElement('div');
            snake.className = 'snake';
            document.body.appendChild(snake);

            const segments = [];
            const segmentCount = 20;
            const colors = [
                '#ff3333', '#ff6633', '#ff9933', '#ffcc33', 
                '#ffff33', '#99ff33', '#33ff33', '#33ff99', 
                '#33ffff', '#3399ff', '#3333ff', '#9933ff'
            ];

            // 初始化在屏幕中央
            const startX = window.innerWidth / 2;
            const startY = window.innerHeight / 2;

            // 创建蛇的段
            for (let i = 0; i < segmentCount; i++) {
                const segment = document.createElement('div');
                segment.className = 'snake-segment';
                segment.style.setProperty('--color', colors[i % colors.length]);
                snake.appendChild(segment);
                
                segments.push({
                    element: segment,
                    x: startX,
                    y: startY
                });
            }

            let time = 0;

            function updateSnake() {
                time += 0.003;

                // 计算中心点
                const centerX = window.innerWidth / 2;
                const centerY = window.innerHeight / 2;

                // 使用多个正弦波创造复杂的轨迹
                const radius = Math.min(window.innerWidth, window.innerHeight) * 0.2;
                const t1 = time * 0.7;  // 慢速旋转
                const t2 = time * 2;    // 快速波动
                const t3 = time * 0.3;  // 超慢速变化

                // 组合多个运动
                const x1 = Math.sin(t1) * radius * 0.8;
                const y1 = Math.cos(t1) * radius * 0.8;
                
                const x2 = Math.sin(t2) * radius * 0.3;
                const y2 = Math.cos(t2 * 1.5) * radius * 0.3;
                
                const x3 = Math.sin(t3) * radius * 0.2;
                const y3 = Math.cos(t3 * 2) * radius * 0.2;

                const targetX = centerX + x1 + x2 + x3;
                const targetY = centerY + y1 + y2 + y3;

                // 更新蛇的每个段
                segments.forEach((segment, index) => {
                    if (index === 0) {
                        // 头部平滑追踪
                        const dx = targetX - segment.x;
                        const dy = targetY - segment.y;
                        segment.x += dx * 0.08;
                        segment.y += dy * 0.08;
                    } else {
                        const prevSegment = segments[index - 1];
                        const dx = prevSegment.x - segment.x;
                        const dy = prevSegment.y - segment.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        const idealDistance = 12;
                        
                        // 添加一些随机摆动
                        const wiggle = Math.sin(time * 5 + index * 0.5) * 0.3;
                        const angle = Math.atan2(dy, dx) + wiggle;
                        
                        // 弹性跟随
                        const speed = 0.15 + Math.sin(time * 2 + index * 0.2) * 0.05;
                        segment.x += dx * speed;
                        segment.y += dy * speed;
                    }

                    // 更新视觉效果
                    const scale = 1 - index * 0.02;
                    const breathe = 1 + Math.sin(time * 3 + index * 0.2) * 0.05; // 添加呼吸效果
                    segment.element.style.left = `${segment.x}px`;
                    segment.element.style.top = `${segment.y}px`;
                    segment.element.style.transform = `translate(-50%, -50%) scale(${scale * breathe})`;
                    segment.element.style.opacity = 1 - (index / segmentCount) * 0.3;
                });

                requestAnimationFrame(updateSnake);
            }

            updateSnake();
        }

        // 创建蛇
        createSnake();

        // 创建彩虹
        function createRainbow() {
            const rainbow = document.createElement('div');
            rainbow.className = 'rainbow';
            document.body.appendChild(rainbow);
        }

        // 创建彩虹
        createRainbow();

        // 添加一个特殊的键盘组合触发彩蛋
        let konami = '';
        const konamiCode = 'ArrowUpArrowUpArrowDownArrowDownArrowLeftArrowRightArrowLeftArrowRightba';
        
        document.addEventListener('keydown', (e) => {
            konami += e.key;
            if (konami.length > konamiCode.length) {
                konami = konami.substr(konami.length - konamiCode.length);
            }
            
            if (konami === konamiCode) {
                // 触发彩蛋效果
                activateSecretMode();
                konami = '';
            }
        });

        // 修改彩蛋触发函数
        function activateSecretMode() {
            // 获取元素
            const message = document.querySelector('.message');
            const messages = document.querySelectorAll('.poem-line');
            const heart = document.querySelector('.heart');
            
            // 淡出所有元素
            message.style.opacity = '0';
            
            // 等待淡出完成后显示秘密消息
            setTimeout(() => {
                // 创建并显示秘密消息
                const secret = document.createElement('div');
                secret.className = 'secret-message';
                secret.style.position = 'fixed';
                secret.style.top = '50%';
                secret.style.left = '50%';
                secret.style.transform = 'translate(-50%, -50%) scale(0.8)';
                secret.style.fontSize = '3em';
                secret.style.color = '#fff';
                secret.style.textShadow = '0 0 10px rgba(255, 77, 77, 0.7)';
                secret.style.opacity = '0';
                secret.style.transition = 'all 1s ease';
                secret.style.zIndex = '10000';
                secret.style.textAlign = 'center';
                
                const text = document.createElement('div');
                text.innerHTML = '愿你所愿皆成真 <br>';
                text.style.marginBottom = '20px';
                
                const subText = document.createElement('div');
                subText.textContent = '星光不负赶路人';
                subText.style.fontSize = '0.6em';
                subText.style.opacity = '0.8';
                subText.style.fontWeight = 'lighter';
                subText.style.letterSpacing = '3px';
                
                const heartIcon = document.createElement('span');
                heartIcon.className = 'secret-heart';
                heartIcon.textContent = '✨';
                heartIcon.style.fontSize = '0.8em';
                heartIcon.style.margin = '0 10px';
                heartIcon.style.color = '#ffd700';
                heartIcon.style.textShadow = '0 0 15px rgba(255, 215, 0, 0.8)';
                
                secret.appendChild(text);
                secret.appendChild(subText);
                document.body.appendChild(secret);
                
                // 显示秘密消息和特效
                requestAnimationFrame(() => {
                    secret.style.opacity = '1';
                    secret.style.transform = 'translate(-50%, -50%) scale(1)';
                    
                    // 增加烟花数量和持续时间
                    const burstCount = 30; // 从20增加到30
                    for (let i = 0; i < burstCount; i++) {
                        setTimeout(() => {
                            // 随机位置偏移
                            const angle = (i / burstCount) * Math.PI * 2;
                            const baseDistance = Math.min(window.innerWidth, window.innerHeight) * 0.3;
                            const randomOffset = Math.random() * 100 - 50; // 添加随机偏移
                            const distance = baseDistance + randomOffset;
                            
                            const x = window.innerWidth / 2 + Math.cos(angle) * distance;
                            const y = window.innerHeight / 2 + Math.sin(angle) * distance;
                            
                            // 每个位置创建多个烟花
                            const burstSize = Math.random() > 0.7 ? 2 : 1; // 30%概率创建双重烟花
                            for(let j = 0; j < burstSize; j++) {
                                setTimeout(() => {
                                    createStarBurst(
                                        x + (Math.random() * 40 - 20), 
                                        y + (Math.random() * 40 - 20)
                                    );
                                }, j * 100);
                            }
                        }, i * 100); // 缩短间隔从120ms到100ms
                    }

                    // 增加漂浮星星数量
                    for (let i = 0; i < 50; i++) { // 从40增加到50
                        setTimeout(() => createFloatingStar(), i * 50); // 缩短间隔从60ms到50ms
                    }
                });

                // 4秒后淡出秘密消息并恢复原始内容
                setTimeout(() => {
                    secret.style.opacity = '0';
                    secret.style.transform = 'translate(-50%, -50%) scale(0.8)';
                    
                    setTimeout(() => {
                        secret.remove();
                        message.style.opacity = '1';
                    }, 1000);
                }, 6000);
            }, 500);
        }

        // 修改星星爆发特效
        function createStarBurst(x, y) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            
            // 增加颜色种类
            const colors = [
                '#ffd700', // 金色
                '#fff5b1', // 浅金
                '#fffacd', // 柠檬绸
                '#ffffe0', // 浅黄
                '#ff69b4', // 粉色
                '#ff8c00', // 深橙色
                '#ff4500'  // 橙红色
            ];
            
            // 增加粒子数量
            const particles = 24; // 从12增加到24
            for (let i = 0; i < particles; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework-particle';
                // 随机使用星星或圆点
                particle.innerHTML = Math.random() > 0.5 ? '✨' : '●';
                particle.style.fontSize = Math.random() * 15 + 10 + 'px';
                
                const angle = (i / particles) * Math.PI * 2;
                // 增加随机距离变化
                const distance = Math.random() * 100 + 50;
                const tx = Math.cos(angle) * distance;
                const ty = Math.sin(angle) * distance;
                
                particle.style.setProperty('--tx', tx + 'px');
                particle.style.setProperty('--ty', ty + 'px');
                particle.style.color = colors[Math.floor(Math.random() * colors.length)];
                
                firework.appendChild(particle);
            }
            
            document.body.appendChild(firework);
            setTimeout(() => firework.remove(), 1500);
        }

        // 添加漂浮的星星效果
        function createFloatingStar() {
            const star = document.createElement('div');
            star.className = 'floating-heart'; // 复用现有的动画类
            star.innerHTML = '✨';
            star.style.position = 'fixed';
            star.style.left = Math.random() * window.innerWidth + 'px';
            star.style.top = window.innerHeight + 'px';
            star.style.color = `hsl(${Math.random() * 30 + 45}, 100%, 70%)`; // 金黄色系
            star.style.fontSize = Math.random() * 15 + 15 + 'px';
            star.style.animation = `floatUp ${Math.random() * 2 + 3}s ease-out forwards`;
            star.style.textShadow = '0 0 10px rgba(255, 215, 0, 0.8)';
            
            document.body.appendChild(star);
            setTimeout(() => star.remove(), 5000);
        }

        // 创建星空效果
        function createStarrySky() {
            const sky = document.createElement('div');
            sky.className = 'starry-sky';
            document.body.appendChild(sky);

            // 创建背景星星
            for (let i = 0; i < 200; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                // 随机大小和位置
                const size = Math.random() * 2 + 1;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                
                // 随机动画参数
                star.style.setProperty('--duration', Math.random() * 3 + 2 + 's');
                star.style.setProperty('--brightness', Math.random() * 0.5 + 0.3);
                star.style.animationDelay = Math.random() * 3 + 's';
                
                sky.appendChild(star);
            }

            // 定期创建流星
            setInterval(() => {
                const shootingStar = document.createElement('div');
                shootingStar.className = 'shooting-star';
                
                // 设置流星参数
                const angle = Math.random() * 45 - 45; // -45到0度之间
                const distance = Math.random() * 200 + 100;
                const duration = Math.random() * 1 + 1;
                const startX = Math.random() * window.innerWidth;
                const startY = Math.random() * window.innerHeight * 0.5;
                
                shootingStar.style.left = startX + 'px';
                shootingStar.style.top = startY + 'px';
                shootingStar.style.setProperty('--angle', angle + 'deg');
                shootingStar.style.setProperty('--distance', distance + 'px');
                shootingStar.style.setProperty('--duration', duration + 's');
                shootingStar.style.setProperty('--brightness', 0.8);
                
                sky.appendChild(shootingStar);
                setTimeout(() => shootingStar.remove(), duration * 1000);
            }, 2000);
        }

        // 创建星空
        createStarrySky();

        // 添加持续的背景烟花效果
        function createBackgroundFireworks() {
            // 随机位置生成烟花
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * (window.innerHeight * 0.7); // 控制高度范围
            
            // 创建上升的火花
            const trail = document.createElement('div');
            trail.style.position = 'fixed';
            trail.style.left = x + 'px';
            trail.style.bottom = '0';
            trail.style.width = '2px';
            trail.style.height = '2px';
            trail.style.background = '#ffd700';
            trail.style.boxShadow = '0 0 6px #ffd700';
            trail.style.borderRadius = '50%';
            trail.style.transform = 'translateY(0)';
            trail.style.transition = 'transform 1s ease-out';
            document.body.appendChild(trail);
            
            // 上升动画
            requestAnimationFrame(() => {
                trail.style.transform = `translateY(${-(window.innerHeight - y)}px)`;
            });
            
            // 到达顶点后爆炸
            setTimeout(() => {
                trail.remove();
                createBackgroundBurst(x, y);
            }, 1000);
            
            // 随机间隔后继续创建
            setTimeout(createBackgroundFireworks, Math.random() * 800 + 400);
        }

        // 背景烟花爆炸效果
        function createBackgroundBurst(x, y) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            firework.style.zIndex = '-1'; // 确保在背景层
            
            const colors = [
                '#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1',
                '#96f7d2', '#f7d794', '#f8a5c2', '#778beb'
            ];
            
            const particles = 20;
            for (let i = 0; i < particles; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework-particle';
                
                // 随机使用不同的形状
                const shapes = ['✦', '✬', '⭐', '✶', '●'];
                particle.innerHTML = shapes[Math.floor(Math.random() * shapes.length)];
                particle.style.fontSize = Math.random() * 8 + 6 + 'px'; // 背景烟花稍小
                
                const angle = (i / particles) * Math.PI * 2;
                const distance = Math.random() * 60 + 30; // 爆炸范围稍小
                const tx = Math.cos(angle) * distance;
                const ty = Math.sin(angle) * distance;
                
                particle.style.setProperty('--tx', tx + 'px');
                particle.style.setProperty('--ty', ty + 'px');
                particle.style.color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.opacity = '0.6'; // 降低背景烟花的不透明度
                
                firework.appendChild(particle);
            }
            
            document.body.appendChild(firework);
            setTimeout(() => firework.remove(), 1500);
        }

        // 在页面加载时启动背景烟花
        setTimeout(() => {
            createBackgroundFireworks();
        }, 1000);
    </script>
</body>
</html>
